<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.554">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>KAIST Deep Learning - 2&nbsp; Day1 Optimization</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./day2_neural_networks.html" rel="next">
<link href="./index.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./day1_optimization.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Day1 Optimization</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">KAIST Deep Learning</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Home</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./day1_optimization.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Day1 Optimization</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./day2_neural_networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Day2 Neural Networks</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./day3_cnn_dna.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Day3 CNN with DNA sequence</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./day4_cnn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Day4 CNN with details</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./day5_model_evaluation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Day5 Model Evaluation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./day6_seq2seq.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Day6 Seq2Seq - Encoder</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./day7_seq2seq_aa.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Day7 Seq2Seq with Amino Acid</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction-of-google-colab" id="toc-introduction-of-google-colab" class="nav-link active" data-scroll-target="#introduction-of-google-colab"><span class="header-section-number">2.1</span> Introduction of Google Colab</a></li>
  <li><a href="#numpy" id="toc-numpy" class="nav-link" data-scroll-target="#numpy"><span class="header-section-number">2.2</span> NumPy</a>
  <ul class="collapse">
  <li><a href="#basics-of-numpy" id="toc-basics-of-numpy" class="nav-link" data-scroll-target="#basics-of-numpy"><span class="header-section-number">2.2.1</span> Basics of NumPy</a></li>
  </ul></li>
  <li><a href="#simple-linear-regression" id="toc-simple-linear-regression" class="nav-link" data-scroll-target="#simple-linear-regression"><span class="header-section-number">2.3</span> Simple linear regression</a>
  <ul class="collapse">
  <li><a href="#ordinary-least-sequare-ols" id="toc-ordinary-least-sequare-ols" class="nav-link" data-scroll-target="#ordinary-least-sequare-ols"><span class="header-section-number">2.3.1</span> Ordinary least sequare (OLS)</a></li>
  <li><a href="#maximum-likelihood-estimation-mle" id="toc-maximum-likelihood-estimation-mle" class="nav-link" data-scroll-target="#maximum-likelihood-estimation-mle"><span class="header-section-number">2.3.2</span> Maximum Likelihood Estimation (MLE)</a></li>
  <li><a href="#gradient-decent" id="toc-gradient-decent" class="nav-link" data-scroll-target="#gradient-decent"><span class="header-section-number">2.3.3</span> Gradient Decent</a></li>
  <li><a href="#model-fitting" id="toc-model-fitting" class="nav-link" data-scroll-target="#model-fitting"><span class="header-section-number">2.3.4</span> Model fitting</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Day1 Optimization</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<ul>
<li>Learn python for biological data analysis with chatGPT</li>
<li>colab의 default working directory에 개인의 google drive 연결</li>
</ul>
<div id="cell-1" class="cell" data-outputid="9fac89b2-a8e5-4e4a-8aa7-a9e72c501b6e">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> google.colab <span class="im">import</span> drive</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>drive.mount(<span class="st">'/content/drive'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="introduction-of-google-colab" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="introduction-of-google-colab"><span class="header-section-number">2.1</span> Introduction of Google Colab</h2>
<section id="access-google-colab" class="level4" data-number="2.1.0.1">
<h4 data-number="2.1.0.1" class="anchored" data-anchor-id="access-google-colab"><span class="header-section-number">2.1.0.1</span> Access Google Colab</h4>
<ul>
<li>Go to <a href="https://colab.research.google.com/">Google Colab</a> in your web browser.</li>
<li>Sign in with your Google account.</li>
</ul>
</section>
<section id="create-a-new-notebook" class="level4" data-number="2.1.0.2">
<h4 data-number="2.1.0.2" class="anchored" data-anchor-id="create-a-new-notebook"><span class="header-section-number">2.1.0.2</span> Create a New Notebook</h4>
<ul>
<li>Click on <code>File</code> -&gt; <code>New Notebook</code> to create a new notebook.</li>
</ul>
</section>
<section id="install-required-libraries" class="level4" data-number="2.1.0.3">
<h4 data-number="2.1.0.3" class="anchored" data-anchor-id="install-required-libraries"><span class="header-section-number">2.1.0.3</span> Install Required Libraries</h4>
<p>Google Colab comes with many libraries pre-installed, but you might need to install some additional ones, such as <code>biopython</code> and <code>scikit-bio</code>. You can do this using the <code>!pip install</code> command directly in a cell.</p>
<div id="cell-3" class="cell" data-outputid="0e80e3cb-7d37-4a8f-cbaf-a391a03d6aec">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install biopython scikit<span class="op">-</span>bio matplotlib</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-4" class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install scikit<span class="op">-</span>bio</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="import-libraries-and-verify-installation" class="level4" data-number="2.1.0.4">
<h4 data-number="2.1.0.4" class="anchored" data-anchor-id="import-libraries-and-verify-installation"><span class="header-section-number">2.1.0.4</span> Import Libraries and Verify Installation</h4>
<p>In a new code cell, import the libraries to ensure they are installed correctly.</p>
<div id="cell-6" class="cell" data-outputid="c65f85bd-8294-4606-e90e-586fe7170cc6" data-execution_count="1">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Importing necessary libraries</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> Bio</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> skbio</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Biopython version:"</span>, Bio.__version__)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"scikit-bio version:"</span>, skbio.__version__)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Biopython version: 1.84
scikit-bio version: 0.6.2</code></pre>
</div>
</div>
</section>
<section id="upload-files-to-colab" class="level4" data-number="2.1.0.5">
<h4 data-number="2.1.0.5" class="anchored" data-anchor-id="upload-files-to-colab"><span class="header-section-number">2.1.0.5</span> Upload Files to Colab</h4>
<ul>
<li><p>Create <code>2024-kaist-lecture</code> folder</p></li>
<li><p>ipynb file open with colab</p></li>
<li><p>Download ganbank files from ncbi and upload the files</p></li>
<li><p>current directory</p></li>
</ul>
<div id="cell-9" class="cell" data-outputid="b07334f5-df6e-433d-e8df-a62fb1d98882" data-execution_count="2">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pwd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>/home/haseong/lecture/kaist-deeplearning-2024</code></pre>
</div>
</div>
<ul>
<li>현재 작업 디렉토리를 위 생성한 디렉토리로 변경</li>
</ul>
<div id="cell-11" class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>os.chdir(<span class="st">'drive/MyDrive/2024-kaist-lecture'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-12" class="cell" data-outputid="5c1878e5-992d-47ff-e946-75b820f1b778">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pwd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>/content/drive/MyDrive/2024-kaist-lecture</code></pre>
</div>
</div>
<ul>
<li>분석을 위한 genbank 등의 파일을 ncbi에서 다운로드 후 위 폴더에 복사</li>
<li>또는 아래 코드를 이용해서 현재 작업 디렉토리에 업로드</li>
</ul>
<div id="cell-14" class="cell" data-outputid="de42a665-c59c-46c8-efe9-f000a88cf920">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> google.colab <span class="im">import</span> files</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>uploaded <span class="op">=</span> files.upload()</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Listing the uploaded files</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> filename <span class="kw">in</span> uploaded.keys():</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(filename)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

     <input type="file" id="files-29ceb87f-630f-4300-b32e-abf577f65510" name="files[]" multiple="" disabled="" style="border:none">
     <output id="result-29ceb87f-630f-4300-b32e-abf577f65510">
      Upload widget is only available when the cell has been executed in the
      current browser session. Please rerun this cell to enable.
      </output>
      <script>// Copyright 2017 Google LLC
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//      http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

/**
 * @fileoverview Helpers for google.colab Python module.
 */
(function(scope) {
function span(text, styleAttributes = {}) {
  const element = document.createElement('span');
  element.textContent = text;
  for (const key of Object.keys(styleAttributes)) {
    element.style[key] = styleAttributes[key];
  }
  return element;
}

// Max number of bytes which will be uploaded at a time.
const MAX_PAYLOAD_SIZE = 100 * 1024;

function _uploadFiles(inputId, outputId) {
  const steps = uploadFilesStep(inputId, outputId);
  const outputElement = document.getElementById(outputId);
  // Cache steps on the outputElement to make it available for the next call
  // to uploadFilesContinue from Python.
  outputElement.steps = steps;

  return _uploadFilesContinue(outputId);
}

// This is roughly an async generator (not supported in the browser yet),
// where there are multiple asynchronous steps and the Python side is going
// to poll for completion of each step.
// This uses a Promise to block the python side on completion of each step,
// then passes the result of the previous step as the input to the next step.
function _uploadFilesContinue(outputId) {
  const outputElement = document.getElementById(outputId);
  const steps = outputElement.steps;

  const next = steps.next(outputElement.lastPromiseValue);
  return Promise.resolve(next.value.promise).then((value) => {
    // Cache the last promise value to make it available to the next
    // step of the generator.
    outputElement.lastPromiseValue = value;
    return next.value.response;
  });
}

/**
 * Generator function which is called between each async step of the upload
 * process.
 * @param {string} inputId Element ID of the input file picker element.
 * @param {string} outputId Element ID of the output display.
 * @return {!Iterable<!Object>} Iterable of next steps.
 */
function* uploadFilesStep(inputId, outputId) {
  const inputElement = document.getElementById(inputId);
  inputElement.disabled = false;

  const outputElement = document.getElementById(outputId);
  outputElement.innerHTML = '';

  const pickedPromise = new Promise((resolve) => {
    inputElement.addEventListener('change', (e) => {
      resolve(e.target.files);
    });
  });

  const cancel = document.createElement('button');
  inputElement.parentElement.appendChild(cancel);
  cancel.textContent = 'Cancel upload';
  const cancelPromise = new Promise((resolve) => {
    cancel.onclick = () => {
      resolve(null);
    };
  });

  // Wait for the user to pick the files.
  const files = yield {
    promise: Promise.race([pickedPromise, cancelPromise]),
    response: {
      action: 'starting',
    }
  };

  cancel.remove();

  // Disable the input element since further picks are not allowed.
  inputElement.disabled = true;

  if (!files) {
    return {
      response: {
        action: 'complete',
      }
    };
  }

  for (const file of files) {
    const li = document.createElement('li');
    li.append(span(file.name, {fontWeight: 'bold'}));
    li.append(span(
        `(${file.type || 'n/a'}) - ${file.size} bytes, ` +
        `last modified: ${
            file.lastModifiedDate ? file.lastModifiedDate.toLocaleDateString() :
                                    'n/a'} - `));
    const percent = span('0% done');
    li.appendChild(percent);

    outputElement.appendChild(li);

    const fileDataPromise = new Promise((resolve) => {
      const reader = new FileReader();
      reader.onload = (e) => {
        resolve(e.target.result);
      };
      reader.readAsArrayBuffer(file);
    });
    // Wait for the data to be ready.
    let fileData = yield {
      promise: fileDataPromise,
      response: {
        action: 'continue',
      }
    };

    // Use a chunked sending to avoid message size limits. See b/62115660.
    let position = 0;
    do {
      const length = Math.min(fileData.byteLength - position, MAX_PAYLOAD_SIZE);
      const chunk = new Uint8Array(fileData, position, length);
      position += length;

      const base64 = btoa(String.fromCharCode.apply(null, chunk));
      yield {
        response: {
          action: 'append',
          file: file.name,
          data: base64,
        },
      };

      let percentDone = fileData.byteLength === 0 ?
          100 :
          Math.round((position / fileData.byteLength) * 100);
      percent.textContent = `${percentDone}% done`;

    } while (position < fileData.byteLength);
  }

  // All done.
  yield {
    response: {
      action: 'complete',
    }
  };
}

scope.google = scope.google || {};
scope.google.colab = scope.google.colab || {};
scope.google.colab._files = {
  _uploadFiles,
  _uploadFilesContinue,
};
})(self);
</script> 
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Saving nn.png to nn.png
nn.png</code></pre>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="data:image/png;base64,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" class="img-fluid figure-img"></p>
<figcaption>image.png</figcaption>
</figure>
</div>
</section>
</section>
<section id="numpy" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="numpy"><span class="header-section-number">2.2</span> NumPy</h2>
<p>NumPy is a powerful library for numerical operations and handling arrays.</p>
<section id="basics-of-numpy" class="level3" data-number="2.2.1">
<h3 data-number="2.2.1" class="anchored" data-anchor-id="basics-of-numpy"><span class="header-section-number">2.2.1</span> Basics of NumPy</h3>
<p><strong>Installation:</strong></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="ex">!pip</span> install numpy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="cell-17" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a 1D array</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>arr1 <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>])</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a 2D array</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>arr2 <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>]])</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(arr1)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(arr2)</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Element-wise operations</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>arr3 <span class="op">=</span> arr1 <span class="op">*</span> <span class="dv">2</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(arr3)</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Mathematical functions</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(np.sqrt(arr1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1 2 3 4 5]
[[1 2 3]
 [4 5 6]]
[ 2  4  6  8 10]
[1.         1.41421356 1.73205081 2.         2.23606798]</code></pre>
</div>
</div>
<section id="numpy-datatype-ndarray" class="level4" data-number="2.2.1.1">
<h4 data-number="2.2.1.1" class="anchored" data-anchor-id="numpy-datatype-ndarray"><span class="header-section-number">2.2.1.1</span> Numpy datatype ndarray</h4>
<ul>
<li>행렬이나 다차원 배열 처리용 파이썬 라이브러리</li>
<li>같은 타입의 데이터만 허용</li>
<li>리스트에 비해 20배 이상 빠른 속도</li>
</ul>
<div id="cell-20" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>display(np.ones(<span class="dv">4</span>))</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>display(np.ones((<span class="dv">3</span>, <span class="dv">4</span>)))</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>display(np.ones((<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>array([1., 1., 1., 1.])</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>array([[1., 1., 1., 1.],
       [1., 1., 1., 1.],
       [1., 1., 1., 1.]])</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>array([[[1., 1., 1., 1.],
        [1., 1., 1., 1.],
        [1., 1., 1., 1.]],

       [[1., 1., 1., 1.],
        [1., 1., 1., 1.],
        [1., 1., 1., 1.]]])</code></pre>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/ndim.png" class="img-fluid figure-img"></p>
<figcaption>alt text</figcaption>
</figure>
</div>
<ul>
<li>Create numpy objects</li>
</ul>
<div id="cell-23" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>arr <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>]</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(arr)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(arr))</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.array([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>])</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(a)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(a.dtype)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(a.shape)</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(a))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1, 2, 3]
&lt;class 'list'&gt;
[1 2 3]
int64
(3,)
&lt;class 'numpy.ndarray'&gt;</code></pre>
</div>
</div>
<div id="cell-24" class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>arr2 <span class="op">=</span> np.array([[<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>], [<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>]])</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(arr2)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(arr2))</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(arr2.shape)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(arr2.dtype)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1 2 3]
 [4 5 6]]
&lt;class 'numpy.ndarray'&gt;
(2, 3)
int64</code></pre>
</div>
</div>
<ul>
<li>numpy 자료형
<ul>
<li>부호가 있는 정수 int(8, 16, 32, 64)</li>
<li>부호가 없는 정수 uint(8 ,16, 32, 54)</li>
<li>실수 float(16, 32, 64, 128)</li>
<li>복소수 complex(64, 128, 256)</li>
<li>불리언 bool</li>
<li>문자열 string_</li>
<li>파이썬 오프젝트 object</li>
<li>유니코드 unicode_</li>
</ul></li>
<li>np.zeros(), np.ones(), np.arange()</li>
<li>행렬 연산 지원</li>
</ul>
<div id="cell-27" class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.arange(<span class="dv">1</span>, <span class="dv">10</span>).reshape(<span class="dv">3</span>,<span class="dv">3</span>) <span class="co"># [1, 10)</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(a)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.ones((<span class="dv">3</span>,<span class="dv">4</span>), dtype<span class="op">=</span>np.int16)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> np.ones((<span class="dv">3</span>,<span class="dv">4</span>), dtype<span class="op">=</span>np.int16)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(a)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(b)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(a<span class="op">+</span>b)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(a<span class="op">-</span>b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1 2 3]
 [4 5 6]
 [7 8 9]]
[[1 1 1 1]
 [1 1 1 1]
 [1 1 1 1]]
[[1 1 1 1]
 [1 1 1 1]
 [1 1 1 1]]
[[2 2 2 2]
 [2 2 2 2]
 [2 2 2 2]]
[[0 0 0 0]
 [0 0 0 0]
 [0 0 0 0]]</code></pre>
</div>
</div>
<ul>
<li>numpy 함수
<ul>
<li>np.sqrt()</li>
<li>np.log()</li>
<li>np.square()</li>
<li>np.log()</li>
<li>np.ceil()</li>
<li>np.floor()</li>
<li>np.isnan()</li>
<li>np.sum()</li>
<li>np.mean()</li>
<li>np.std()</li>
<li>np.min()</li>
</ul></li>
</ul>
</section>
</section>
</section>
<section id="simple-linear-regression" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="simple-linear-regression"><span class="header-section-number">2.3</span> Simple linear regression</h2>
<ul>
<li><p>Model<br>
<span class="math display">\[
y_i = b_0 + b_1 x_i  + \epsilon_i \text{ where } \epsilon_i \sim \text{ iid } N(0, \sigma^2)
\]</span></p></li>
<li><p>parameters</p></li>
</ul>
<p><span class="math display">\[
\theta = \{ b_0, b_1 \}
\]</span></p>
<ul>
<li>Find <span class="math inline">\(\theta\)</span> that minimize residuals</li>
</ul>
<p><span class="math display">\[
\sum_{i=i}^n r_i^2 = \sum_{i=1}^n (y_i - \hat{y}_i)^2  \\
\sum_{i=1}^n (y_i - \hat{b_1}x_i - \hat{b_0})^2
\]</span></p>
<ul>
<li>residuals: difference between sample observed and estimated values</li>
</ul>
<div id="cell-30" class="cell" data-outputid="51a68395-b376-4454-c9d8-79aa32dc3f97" data-execution_count="4">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">123</span>)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> np.random.rand(<span class="dv">20</span>, <span class="dv">1</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> <span class="dv">4</span> <span class="op">+</span> X<span class="op">*</span><span class="fl">0.8</span> <span class="op">+</span> np.random.rand(<span class="dv">20</span>, <span class="dv">1</span>)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>X_b <span class="op">=</span> np.c_[np.ones(<span class="bu">len</span>(X)), X]</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="co"># print(X)</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>theta_best <span class="op">=</span> np.linalg.inv(X_b.T <span class="op">@</span> X_b) <span class="op">@</span> (X_b.T) <span class="op">@</span> Y</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>Y_pred_org <span class="op">=</span> X_b <span class="op">@</span> theta_best</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="co"># print(theta_best)</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>X_new <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> np.random.rand(<span class="dv">100</span>, <span class="dv">1</span>)</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>X_new_b <span class="op">=</span> np.c_[np.ones(<span class="bu">len</span>(X_new)), X_new]</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>Y_pred <span class="op">=</span> X_new_b <span class="op">@</span> theta_best</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>plt.scatter(X, Y, color<span class="op">=</span><span class="st">"#000000"</span>)</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>plt.plot(X_new, Y_pred, color<span class="op">=</span><span class="st">'#cccccc'</span>, label<span class="op">=</span><span class="st">'Predictions'</span>)</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot residuals</span></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(Y)):</span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>    plt.vlines(x<span class="op">=</span>X[i], ymin<span class="op">=</span><span class="bu">min</span>(Y[i], Y_pred_org[i]), ymax<span class="op">=</span><span class="bu">max</span>(Y[i], Y_pred_org[i]), color<span class="op">=</span><span class="st">'green'</span>, linestyle<span class="op">=</span><span class="st">'dotted'</span>)</span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'X'</span>)</span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Y'</span>)</span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>plt.plot()</span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="day1_optimization_files/figure-html/cell-15-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<section id="ordinary-least-sequare-ols" class="level3" data-number="2.3.1">
<h3 data-number="2.3.1" class="anchored" data-anchor-id="ordinary-least-sequare-ols"><span class="header-section-number">2.3.1</span> Ordinary least sequare (OLS)</h3>
<ul>
<li>Model</li>
</ul>
<p><span class="math display">\[
y_i = b_0 + b_1 x_i  + \epsilon_i \text{ where } \epsilon_i \sim \text{ iid } N(0, \sigma^2), i = 1, 2, ..., n
\]</span></p>
<p><span class="math display">\[
Y = X \beta + \epsilon
\]</span></p>
<p><span class="math display">\[\begin{equation}
\begin{bmatrix}
y_1 \\
y_2 \\
... \\
y_n
\end{bmatrix}

=

\begin{pmatrix}
1 \ \ x_1 \\
1 \ \ x_2 \\
... \\
1 \ \ x_n
\end{pmatrix}

\begin{pmatrix}
b_0 \\
b_1
\end{pmatrix}

+


\begin{pmatrix}
\epsilon_1 \\
\epsilon_2 \\
... \\
\epsilon_n
\end{pmatrix}
\end{equation}\]</span></p>
<p><span class="math display">\[
\mathbf{\epsilon} = Y - X\beta
\]</span></p>
<ul>
<li>Residual Sum of Squares (RSS)</li>
</ul>
<p><span class="math display">\[
RSS = (Y-X\beta)^T(Y-X\beta)
\]</span></p>
<ul>
<li>Take the gradient with respect to <span class="math inline">\(\beta\)</span> and set it to zero (Normal equation)</li>
</ul>
<p><span class="math display">\[
\frac{\partial RSS}{\partial \beta} = -2 X^T Y + 2 X^T X \beta = 0
\]</span></p>
<ul>
<li>Solve for <span class="math inline">\(\beta\)</span> if <span class="math inline">\((X^TX)^{-1}\)</span> exists</li>
</ul>
<p><span class="math display">\[
(X^T X) \beta = X^T Y
\]</span></p>
<p><span class="math display">\[
\hat{\beta} = (X^T X)^{-1} X^T Y
\]</span></p>
</section>
<section id="maximum-likelihood-estimation-mle" class="level3" data-number="2.3.2">
<h3 data-number="2.3.2" class="anchored" data-anchor-id="maximum-likelihood-estimation-mle"><span class="header-section-number">2.3.2</span> Maximum Likelihood Estimation (MLE)</h3>
<ul>
<li><p>Details: https://statproofbook.github.io/P/slr-mle.html</p></li>
<li><p>Consider the regression as a joint probability model</p></li>
<li><p><strong>Reasons to use</strong></p>
<ul>
<li>This framework is applicable to other complex models (non-linear, neural network)</li>
</ul></li>
<li><p>Bayes rule where <span class="math inline">\(D\)</span> is data, <span class="math inline">\(\theta\)</span> is parameter</p></li>
</ul>
<p><span class="math display">\[
p(\theta | D) = \frac{p(D|\theta) p(\theta)}{p(D)}
\]</span></p>
<p><span class="math display">\[
\text{where $p(\theta|D)$, $p(D|\theta)$, $p(\theta)$ are posterior, likelihood and prior, respectively}
\]</span></p>
<p><span class="math display">\[
p(\theta | D) \propto p(D|\theta)
\]</span></p>
<ul>
<li>Regarding the likelihood, <span class="math inline">\(p(Y|X, \theta)\)</span> is interpreted as how the behaviour of the response <span class="math inline">\(Y\)</span> is conditional on the values of the feature, <span class="math inline">\(X\)</span>, and parameters, <span class="math inline">\(\theta\)</span></li>
</ul>
<p><span class="math display">\[
\begin{align}
p(Y | X, \theta)  = \prod_{i=1}^n p( y_i | x_i, \hat{\theta})
\end{align}
\]</span></p>
<ul>
<li>Then, we can ask what is the probability of seeing the data, given a specific set of parameters? (== How the data likely to be observed given the parameters == which parameters maximize the likelihood)</li>
</ul>
<p><span class="math display">\[
\hat{\theta} = \text{argmax}_\theta \text{ log } \sum_{i=1}^n p( y_i | x_i, \theta)
\]</span></p>
<ul>
<li>For <span class="math inline">\(p(y_i | x_i, \theta)\)</span>, we have assumption that all feature vectors are iid</li>
</ul>
<p><span class="math display">\[
Y \sim N(X\beta, \sigma)
\]</span></p>
<p><span class="math display">\[
\begin{align}
p( y_i | x_i, \theta) &amp;= N(y_i; X\beta, \sigma^2) \\
&amp;= \frac{1}{\sqrt{2\pi \sigma^2}} \exp{\left( - \frac{(y_i - b_0 - b_1 x_i)^2}{2 \sigma^2} \right)}
\end{align}
\]</span></p>
<ul>
<li>Log likelihood (LL) function</li>
</ul>
<p><span class="math display">\[
\begin{align}
LL(\theta) &amp;= \text{ log } \left( \prod_{i=1}^n p( y_i | x_i, \theta) \right) \\
&amp;= \text{ log } \left( \prod_{i=1}^n \frac{1}{\sqrt{2\pi \sigma^2}} \exp{ \left(- \frac{(y_i - b_0 - b_1 x_i)^2}{2 \sigma^2} \right)} \right) \\
&amp;= \text{ log } \left( \frac{1}{\sqrt{(2\pi\sigma^2)^n}} \exp{ \left( - \frac{1}{2\sigma^2} \sum_{i=1}^n (y_i - b_0 - b_1 x_i)^2 \right)} \right) \\
&amp;= - \frac{n}{2} \log(2\pi) - \frac{n}{2} \log(\sigma^2) - \frac{1}{2\sigma^2} \sum_{i=1}^n (y_i - b_0 - b_1 x_i)^2
\end{align}
\]</span></p>
<ul>
<li>Take the gradient with respect to <span class="math inline">\(\beta\)</span> and set it to zero (OLS)</li>
</ul>
<p><span class="math display">\[
\frac{\partial LL(b_0, b_1, \sigma^2)}{\partial b_0} = \frac{1}{\sigma^2} \sum_{i=1}^n (y_i - b_0 - b_1 x_i)
\]</span></p>
<p><span class="math display">\[
\begin{align}
\frac{\partial LL(\hat{b}_0, \hat{b}_1, \sigma^2)}{\partial b_0}  = 0 \\
\sum_{i=1}^n (y_i - \hat{b}_0 - \hat{b}_1 x_i) = 0 \\
\hat{b}_0 = \frac{1}{n}\sum_{i=1}^n y_i - \hat{b}_1 \frac{1}{n} \sum_{i=1}^n x_i \\
\end{align}
\]</span></p>
<p><span class="math display">\[
\frac{\partial LL(\hat{b}_0, b_1, \sigma^2)}{\partial b_1} = \frac{1}{\sigma^2} \sum_{i=1}^n (x_i y_i - \hat{b}_0 x_i - b_1 x_i^2)
\]</span></p>
<p><span class="math display">\[
\begin{align}
\frac{\partial LL(\hat{b}_0, \hat{b}_1, \sigma^2)}{\partial b_1}  = 0 \\
\hat{b}_1 = \frac{\sum_{i=1}^n (x_i - \bar{x}) (y_i - \bar{y})}{\sum_{i=1}^n (x_i - \bar{x})^2 }
\end{align}
\]</span></p>
<ul>
<li>Maximize with respect to <span class="math inline">\(\sigma^2\)</span></li>
</ul>
<p><span class="math display">\[
\frac{\partial LL(\hat{b}_0, \hat{b}_1, \sigma^2)}{\partial \sigma^2} = - \frac{n}{2 \sigma^2} + \frac{1}{2 (\sigma^2)^2} \sum_{i=1}^n (y_i - \hat{b}_0 - \hat{b}_1 x_i)^2
\]</span></p>
<p><span class="math display">\[
\frac{\partial LL(\hat{b}_0, \hat{b}_1, \hat{\sigma}^2)}{\partial \sigma^2} = 0 \\
\hat{\sigma}^2 = \frac{1}{n} \sum_{i=1}^n (y_i - \hat{b}_0 - \hat{b}_1 x_i)^2
\]</span></p>
<ul>
<li>In linear regression, MLE naturally leads to the OLS solution under the assumption of normally distributed residuals.</li>
</ul>
<p><span class="math display">\[
\hat{\beta} = (X^T X)^{-1} X^T Y
\]</span></p>
<p><span class="math display">\[
\hat{\sigma}^2 = \frac{1}{n} (Y-X\beta)^T (Y-X\beta)
\]</span></p>
<ul>
<li>However, MLE’s flexibility (e.g.&nbsp;customizable likelihood) extends beyond linear models, making it indispensable for logistic regression, mixture models, and modern deep learning frameworks.</li>
</ul>
</section>
<section id="gradient-decent" class="level3" data-number="2.3.3">
<h3 data-number="2.3.3" class="anchored" data-anchor-id="gradient-decent"><span class="header-section-number">2.3.3</span> Gradient Decent</h3>
<ul>
<li><p>An iterative optimization algorithm for adjusting <span class="math inline">\(\beta\)</span> by minimizing a cost function. In linear regression, the cost function is the Mean Squared Error (MSE) under the assumption of normally distributed residuals.</p></li>
<li><p>Define a cost function <span class="math inline">\(J(\theta)\)</span></p></li>
</ul>
<p><span class="math display">\[
LL(\theta) = - \frac{n}{2} \log(2\pi) - \frac{n}{2} \log(\sigma^2) - \frac{1}{2\sigma^2} \sum_{i=1}^n (y_i - b_0 - b_1 x_i)^2
\]</span></p>
<p><span class="math display">\[
J(\beta) =  \sum_{i=1}^n (y_i - b_0 - b_1 x_i)^2
\]</span></p>
<ul>
<li>matrix notation</li>
</ul>
<p><span class="math display">\[
J(\beta) = || Y - X\beta ||^2 = (Y - X\beta)^T(Y - X\beta)
\]</span></p>
<ul>
<li>L1 norm, L2 norm (a metric for length or magnitude of a vector/matrix) <span class="math display">\[
||X||_1 = \sum_{i}^n |x_i|
\]</span></li>
</ul>
<p><span class="math display">\[
||X||_2 = \sqrt{\sum_i^n x_i^2}
\]</span></p>
<p><span class="math display">\[
J(\beta) = Y^T Y - 2 Y^T X \beta + \beta^T X^T X \beta
\]</span></p>
<ul>
<li>Gradient of the cost function</li>
</ul>
<p><span class="math display">\[
\nabla_\beta J(\beta) = \frac{\partial J(\beta)}{\partial \beta}
\]</span></p>
<p><span class="math display">\[
\begin{align}
\nabla_\beta J(\beta) &amp;= 0 - 2 X^T Y + 2 X^T X \beta \\
&amp;= - 2 X^T(Y-X\beta)
\end{align}
\]</span></p>
<ul>
<li>parameter update rule</li>
</ul>
<p><span class="math display">\[
\beta^{(t+1)} = \beta^{(t)} - \alpha \nabla_\beta J(\beta) \text{ where } \alpha \text{ is learning rate}
\]</span></p>
<div id="cell-46" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate synthetic data</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> np.random.rand(<span class="dv">100</span>, <span class="dv">1</span>)  <span class="co"># 100 samples, 1 feature from [0, 1) uniform distribution</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> <span class="dv">4</span> <span class="op">+</span> <span class="dv">3</span> <span class="op">*</span> X <span class="op">+</span> np.random.randn(<span class="dv">100</span>, <span class="dv">1</span>)  <span class="co"># y = 4 + 3X + noise (Gaussian noise)</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Add bias term (intercept)</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>X_b <span class="op">=</span> np.c_[np.ones((X.shape[<span class="dv">0</span>], <span class="dv">1</span>)), X]</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize parameters</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>beta <span class="op">=</span> np.random.randn(<span class="dv">2</span>, <span class="dv">1</span>)  <span class="co"># Random initial coefficients</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>learning_rate <span class="op">=</span> <span class="fl">0.01</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>n_iterations <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> X_b.shape[<span class="dv">0</span>]  <span class="co"># Number of samples</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>beta_updates <span class="op">=</span> [beta.copy()]</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Gradient Descent</span></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> iteration <span class="kw">in</span> <span class="bu">range</span>(n_iterations):</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>    gradients <span class="op">=</span> <span class="op">-</span><span class="dv">2</span><span class="op">/</span>m <span class="op">*</span> X_b.T <span class="op">@</span> (y <span class="op">-</span> X_b <span class="op">@</span> beta)  <span class="co"># Compute gradient</span></span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>    beta <span class="op">=</span> beta <span class="op">-</span> learning_rate <span class="op">*</span> gradients  <span class="co"># Update parameters</span></span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>    beta_updates.append(beta.copy())</span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Final parameters</span></span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Estimated coefficients (beta):"</span>, beta)</span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Predictions</span></span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> X_b <span class="op">@</span> beta</span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the data and regression line</span></span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a>plt.scatter(X, y, color<span class="op">=</span><span class="st">"blue"</span>, label<span class="op">=</span><span class="st">"Data points"</span>)</span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a>plt.plot(X, y_pred, color<span class="op">=</span><span class="st">"red"</span>, label<span class="op">=</span><span class="st">"Regression line"</span>)</span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"X"</span>)</span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"y"</span>)</span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Linear Regression using Gradient Descent"</span>)</span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Estimated coefficients (beta): [[2.96262018]
 [3.80192916]]</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="day1_optimization_files/figure-html/cell-16-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-47" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize beta updates</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, beta <span class="kw">in</span> <span class="bu">enumerate</span>(beta_updates):</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Iteration </span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">: beta = </span><span class="sc">{</span>beta<span class="sc">.</span>flatten()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot convergence of coefficients</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>beta_updates <span class="op">=</span> np.array(beta_updates).squeeze()</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>plt.plot(<span class="bu">range</span>(n_iterations <span class="op">+</span> <span class="dv">1</span>), beta_updates[:, <span class="dv">0</span>], label<span class="op">=</span><span class="st">'Intercept (beta[0])'</span>)</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>plt.plot(<span class="bu">range</span>(n_iterations <span class="op">+</span> <span class="dv">1</span>), beta_updates[:, <span class="dv">1</span>], label<span class="op">=</span><span class="st">'Slope (beta[1])'</span>)</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Iteration'</span>)</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Value of beta'</span>)</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Convergence of Coefficients'</span>)</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Iteration 0: beta = [0.01300189 1.45353408]
Iteration 1: beta = [0.12180499 1.56507648]
Iteration 2: beta = [0.22633422 1.67181808]
Iteration 3: beta = [0.32676535 1.77395782]
Iteration 4: beta = [0.42326689 1.8716864 ]
Iteration 5: beta = [0.5160004  1.96518667]
Iteration 6: beta = [0.60512075 2.05463391]
Iteration 7: beta = [0.69077645 2.14019616]
Iteration 8: beta = [0.77310984 2.22203453]
Iteration 9: beta = [0.85225741 2.30030345]
Iteration 10: beta = [0.92835001 2.37515099]
Iteration 11: beta = [1.00151308 2.44671909]
Iteration 12: beta = [1.0718669  2.51514384]
Iteration 13: beta = [1.13952675 2.58055569]
Iteration 14: beta = [1.20460319 2.64307972]
Iteration 15: beta = [1.26720221 2.70283582]
Iteration 16: beta = [1.32742539 2.75993895]
Iteration 17: beta = [1.38537016 2.81449929]
Iteration 18: beta = [1.4411299 2.8666225]
Iteration 19: beta = [1.49479416 2.91640985]
Iteration 20: beta = [1.54644877 2.96395843]
Iteration 21: beta = [1.59617603 3.00936133]
Iteration 22: beta = [1.64405484 3.05270779]
Iteration 23: beta = [1.69016085 3.09408334]
Iteration 24: beta = [1.73456657 3.13357001]
Iteration 25: beta = [1.77734155 3.17124641]
Iteration 26: beta = [1.81855245 3.20718793]
Iteration 27: beta = [1.85826316 3.24146681]
Iteration 28: beta = [1.89653497 3.27415234]
Iteration 29: beta = [1.93342661 3.30531092]
Iteration 30: beta = [1.96899442 3.33500621]
Iteration 31: beta = [2.00329239 3.36329925]
Iteration 32: beta = [2.03637228 3.39024855]
Iteration 33: beta = [2.06828373 3.4159102 ]
Iteration 34: beta = [2.09907433 3.44033798]
Iteration 35: beta = [2.1287897  3.46358343]
Iteration 36: beta = [2.15747358 3.48569598]
Iteration 37: beta = [2.1851679 3.506723 ]
Iteration 38: beta = [2.21191288 3.52670991]
Iteration 39: beta = [2.23774706 3.54570024]
Iteration 40: beta = [2.26270741 3.56373574]
Iteration 41: beta = [2.28682934 3.58085643]
Iteration 42: beta = [2.31014685 3.59710066]
Iteration 43: beta = [2.3326925 3.6125052]
Iteration 44: beta = [2.35449751 3.62710531]
Iteration 45: beta = [2.37559184 3.64093478]
Iteration 46: beta = [2.39600419 3.65402601]
Iteration 47: beta = [2.41576208 3.66641005]
Iteration 48: beta = [2.43489191 3.67811668]
Iteration 49: beta = [2.45341896 3.68917444]
Iteration 50: beta = [2.47136752 3.69961069]
Iteration 51: beta = [2.48876082 3.70945165]
Iteration 52: beta = [2.50562118 3.71872248]
Iteration 53: beta = [2.52196997 3.72744726]
Iteration 54: beta = [2.53782769 3.73564912]
Iteration 55: beta = [2.55321401 3.74335019]
Iteration 56: beta = [2.56814776 3.75057171]
Iteration 57: beta = [2.58264703 3.75733403]
Iteration 58: beta = [2.59672912 3.76365667]
Iteration 59: beta = [2.61041067 3.76955833]
Iteration 60: beta = [2.62370759 3.77505693]
Iteration 61: beta = [2.63663515 3.78016967]
Iteration 62: beta = [2.64920801 3.78491302]
Iteration 63: beta = [2.66144021 3.78930278]
Iteration 64: beta = [2.6733452  3.79335407]
Iteration 65: beta = [2.68493589 3.79708142]
Iteration 66: beta = [2.69622467 3.80049874]
Iteration 67: beta = [2.70722341 3.80361935]
Iteration 68: beta = [2.71794348 3.80645605]
Iteration 69: beta = [2.7283958  3.80902108]
Iteration 70: beta = [2.73859083 3.81132618]
Iteration 71: beta = [2.74853861 3.81338263]
Iteration 72: beta = [2.75824876 3.8152012 ]
Iteration 73: beta = [2.7677305  3.81679224]
Iteration 74: beta = [2.77699268 3.81816566]
Iteration 75: beta = [2.78604379 3.81933097]
Iteration 76: beta = [2.79489196 3.82029728]
Iteration 77: beta = [2.803545   3.82107331]
Iteration 78: beta = [2.81201037 3.82166745]
Iteration 79: beta = [2.82029527 3.82208769]
Iteration 80: beta = [2.82840657 3.82234175]
Iteration 81: beta = [2.83635086 3.82243698]
Iteration 82: beta = [2.84413447 3.82238045]
Iteration 83: beta = [2.85176348 3.82217893]
Iteration 84: beta = [2.85924369 3.8218389 ]
Iteration 85: beta = [2.8665807  3.82136659]
Iteration 86: beta = [2.87377985 3.82076795]
Iteration 87: beta = [2.88084627 3.8200487 ]
Iteration 88: beta = [2.8877849  3.81921431]
Iteration 89: beta = [2.89460044 3.81827003]
Iteration 90: beta = [2.90129743 3.81722089]
Iteration 91: beta = [2.90788021 3.8160717 ]
Iteration 92: beta = [2.91435295 3.81482709]
Iteration 93: beta = [2.92071965 3.81349148]
Iteration 94: beta = [2.92698413 3.81206911]
Iteration 95: beta = [2.93315007 3.81056405]
Iteration 96: beta = [2.93922099 3.8089802 ]
Iteration 97: beta = [2.94520029 3.80732128]
Iteration 98: beta = [2.9510912  3.80559087]
Iteration 99: beta = [2.95689684 3.8037924 ]
Iteration 100: beta = [2.96262018 3.80192916]</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="day1_optimization_files/figure-html/cell-17-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<section id="reasons-to-use-gd-instead-of-mle-ols" class="level4" data-number="2.3.3.1">
<h4 data-number="2.3.3.1" class="anchored" data-anchor-id="reasons-to-use-gd-instead-of-mle-ols"><span class="header-section-number">2.3.3.1</span> Reasons to use GD instead of MLE, OLS</h4>
<ul>
<li>Gradient Descent is favored over MLE or OLS in scenarios involving <strong>large-scale data</strong>, <strong>high-dimensional features</strong>, <strong>non-linear models</strong>, or <strong>custom loss functions</strong> due to its flexibility, efficiency, and scalability. However, for simple, small-scale problems, OLS or MLE may still be preferred for their directness and precision.</li>
</ul>
</section>
</section>
<section id="model-fitting" class="level3" data-number="2.3.4">
<h3 data-number="2.3.4" class="anchored" data-anchor-id="model-fitting"><span class="header-section-number">2.3.4</span> Model fitting</h3>
<ul>
<li>Finding parameters with LSE, MLE, and GD</li>
<li>GD provides more flexible (non-linear) and scalable (high-dimentional data) way for modeling</li>
<li>GD procedure
<ul>
<li>Set random initial parameters</li>
<li>Compute gradient that reduces cost</li>
<li>Parameter update until conversing</li>
</ul></li>
</ul>
<p><img src="images/gd2.png" class="img-fluid"></p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./index.html" class="pagination-link" aria-label="Home">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Home</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./day2_neural_networks.html" class="pagination-link" aria-label="Day2 Neural Networks">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Day2 Neural Networks</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>2024 lecture note written by Haseong Kim</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>This book was built with Quarto</p>
</div>
  </div>
</footer>




</body></html>